<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
  <head>
    <title>AHPUT高校论坛首页</title>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>
    <link type="text/css" rel="stylesheet" th:href="@{/css/base.css}"/>
    <link type="text/css" rel="stylesheet" th:href="@{/js/weditor/css/wangEditor.min.css}"/>
    <link type="text/css" rel="stylesheet" th:href="@{/css/post.css}"/>
    <link type="text/css" rel="stylesheet" th:href="@{/css/editor.css}"/>
    <style>
	    body {
			padding: 0px;
			margin: 0px;
			background: #F0F0F0;
			font-family: "微软雅黑";
			font-size: 12px;
		}
    </style>
  </head>
  <body>
 	<!-- header部分开始 -->
	<div id="header">
		<div id="logo">
			<a th:href="@{/posts/index}"><img th:src="@{/images/logo.png}"/></a>
		</div>
		<div id="navigation">
			<ul>
				<li id="user" th:if="${session.loginUser != null}">
					<input id="user_id" type="hidden" th:attr="data-id = ${session.loginUser.id}"/>
					<a class="nickname" th:text="${session.loginUser.nickname}"></a>
					<ul id="user_list">
						<li>
							<a th:href="${#mvc.url('UC#show').arg(3, session.loginUser.id).build()}" target="_blank">个人中心</a></li>
						<li>
							<a th:href="${#mvc.url('UC#logout').arg(0, session.loginUser.id).build()}">退出</a></li>
					</ul>
				</li>
				<li th:if="${session.loginUser == null}">
					<a class="table" th:href="@{/users/login}">登录</a>
				</li>
				<li th:if="${session.loginUser != null}"><a class="table" th:href="${#mvc.url('UC#careUsers').arg(3, session.loginUser.id).build()}">关注的人</a></li>
				<li th:if="${session.loginUser != null}"><a class="table" th:href="${#mvc.url('UC#collects').arg(3, session.loginUser.id).build()}">我的收藏</a></li>
				<li th:if="${session.loginUser != null}"><a class="table" th:href="${#mvc.url('UC#posts').arg(3, session.loginUser.id).build()}">我的发帖</a></li>
				<li style="clear:both;"></li>
			</ul>
		</div>
	</div>
	<!-- header部分结束 -->
	
	<!-- body部分开始 -->
	<div id="body" style="background:#fff">
		<div>
			<div id="post">
				<div id="post_title" th:utext="${notice.title}">标题</div>
				<div id="post_info">
					<span style="color:#0787D8" th:utext="${notice.publishBy.nickname}">作者</span>&nbsp;&nbsp;
					<span style="color:#999" th:text="${#dates.format(notice.createTime,'yyyy-MM-dd HH:mm')}">时间</span>&nbsp;&nbsp;
				</div>
				<div id="post_nr" th:utext="${notice.content}">内容</div>
			</div>
		</div>
	</div>
	<!-- body部分结束-->
	
	<!-- footer部分开始 -->
	<div id="footer">
		<p>Copyright &copy; 2016 by wuchao</p>
	</div>
	<!-- footer部分结束 -->
	
		
	<script type="text/javascript" th:src="@{/js/jquery-1.11.1.min.js}"></script>
	<script type="text/javascript" th:src="@{/js/weditor/js/wangEditor.min.js}"></script>
 	<script type="text/javascript">
	/*<![CDATA[*/
		$("#user").mouseover(function(){
			$("#user_list").show();
		}).mouseleave(function(){
			$("#user_list").hide();
		});
		
		/*初始化输入框*/
   		var Editor = new wangEditor('editor');
   		
   		/*默认配置在wangEditor.js中*/
    	// 菜单配置
	    Editor.config.menus = [
	        'source',
	        'link',
	        'emotion',
	        'img',
	        'video',
	        'location',
	        'insertcode',
	        'fullscreen'
	    ];
		
		// 配置自定义表情，在 create() 之前配置
		Editor.config.emotions = {
		    // 支持多组表情
		
		    // 第一组，id叫做 'default' 
		    'default': {
		        title: '默认',  // 组名称
		        data: 'http://localhost:8080/cblog/resources/js/weditor/static/emotions/default/default.data'  // data 可以是一个url地址，访问该地址要能返回表情包的json文件
		    },
		    // 第二组，id叫做'weibo'
		    'weibo': {
		        title: '微博表情',  // 组名称
		        data: [  // data 还可以直接赋值为一个表情包数组
		            // 第一个表情
		            {
		                'icon': 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/7a/shenshou_thumb.gif',
		                'value': '[草泥马]'
		            },
		            // 第二个表情
		            {
		                'icon': 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/60/horse2_thumb.gif',
		                'value': '[神马]'
		            }
		            // 下面还可以继续，第三个、第四个、第N个表情。。。
		        ]
		    }
		    // 下面还可以继续，第三组、第四组、、、
		};
		
    	Editor.config.uploadImgUrl = '/cblog/upload/uploadImage';	// 上传图片
		Editor.config.pasteFilter = false,	// 粘贴文字时不过滤样式和属性
    	Editor.create();  //创建编辑器
    	
    	var user_id = $("#user_id").data("id");
    	
		/*删帖*/
		function deletePost(obj) {
			var postId = $(obj).prev(".post_id").data("id");
			$.ajax({
				type:"get",
				url:"/cblog/posts/"+postId+"/delete",
				data:{"postId":postId},
				success:function(data){
					if(data.msg.trim() == "success"){
						$(obj).parents("li").slideUp(1000, function(){});
					}else{
						alert("删除失败");
					}
				}
			});
		}

		//判断字符串是否为空
	 	function isEmpty(str){
			if (str == '' || str == null || str == undefined) {
				return true;
			} else {
				return false;
			}
		}
		
		function getLocalTime(time) {     
			var date = new Date(time);
			Y = date.getFullYear() + '-';
			M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-';
			D = date.getDate() < 10 ? '0'+date.getDate()+' ' : date.getDate() + ' ';
			h = date.getHours() < 10 ? '0'+date.getHours()+':' : date.getHours() + ':';
			m = date.getMinutes() < 10 ? '0'+date.getMinutes()+':' : date.getMinutes() + ':';
			s = date.getSeconds() < 10 ? '0'+date.getSeconds() : date.getSeconds(); 
			return(Y+M+D+h+m+s); 
  		}
		
	/*]]>*/
 	</script>
  </body>
</html>
